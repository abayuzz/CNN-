# CNN模型性能对比

本项目提供了一个脚本，用于比较两种卷积神经网络（CNN）架构的性能：简单CNN和深层CNN。对比内容包括参数数量、准确率和推理时间等指标。

## 功能特点

- **SimpleCNN**：一个轻量级的CNN，包含两层卷积层和两层全连接层。
- **DeepCNN**：一个更复杂的CNN，包含四层卷积层、批量归一化、Dropout和四层全连接层。
- **性能指标**：
  - 参数数量
  - 总体准确率
  - 每类准确率
  - 平均推理时间
- **模型加载**：自动加载预训练模型（如果存在）。
- **数据处理**：使用测试数据集进行评估。

## 环境要求

- Python 3.8及以上
- PyTorch
- torchvision
- NumPy
- GPU（可选，但推荐用于加速推理）

## 设置步骤

1. 克隆代码仓库：
   ```bash
   git clone <repository-url>
   cd CNN
   ```

2. 安装所需的Python依赖包：
   ```bash
   pip install -r requirements.txt
   ```

3. 确保测试数据集位于`data/test`目录中。数据集应按照以下结构组织：
   ```
   data/test/
   ├── class1/
   ├── class2/
   └── class3/
   ```

4. 将预训练模型文件放置在项目目录中：
   - `simple_cnn_model.pth`（用于SimpleCNN）
   - `cnn_model.pth`或`best_cnn_model.pth`（用于DeepCNN）

## 使用方法

运行脚本以比较模型性能：
```bash
python model_comparison.py
```

### 输出内容

脚本将显示：
- 两种模型的参数数量
- 每种模型的准确率和推理时间
- 每类的准确率
- 性能改进总结

## 示例输出

```
======================================================================
CNN模型性能对比测试
======================================================================
使用设备: cuda
测试数据: 300 张图片

模型参数对比:
简单CNN参数数量: 123,456
深层CNN参数数量: 12,345,678
参数增加倍数: 100.0x

测试 简单CNN 性能...
总体准确率: 85.00%
平均推理时间: 5.00ms
各类别准确率:
  paper: 90.00% (90/100)
  rock: 80.00% (80/100)
  scissors: 85.00% (85/100)

测试 深层CNN 性能...
总体准确率: 95.00%
平均推理时间: 10.00ms
各类别准确率:
  paper: 95.00% (95/100)
  rock: 94.00% (94/100)
  scissors: 96.00% (96/100)

======================================================================
性能对比总结
======================================================================
模型            参数数量         准确率           推理时间         状态
----------------------------------------------------------------------
简单CNN         123,456          85.00%          5.00ms          ✓ 可用
深层CNN         12,345,678       95.00%          10.00ms         ✓ 可用

改进效果:
准确率提升: +10.00%
速度变化: 慢了 2.0x

建议:
✓ 深层CNN在准确率上有显著提升，推荐使用

测试完成!
```

## 注意事项

- 请确保在运行脚本前，测试数据集和模型文件已正确放置。
- 脚本会自动检测GPU是否可用，并在可能的情况下使用GPU进行推理。

## 许可证

本项目基于MIT许可证。
